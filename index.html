<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>今天中午吃什么</title>
		<link rel="stylesheet" href="./basic.css" />
		<link rel="stylesheet" href="./style.css" />
	</head>
	<body>
		<div id="container">
			<h2 class="time">{{ currentTime }}</h2>
			<div class="container__inner">
				<h3>决定了，就是你！{{ food }}</h3>
				<button @click="startRandom" size="small" plain>
					{{ randomFoods ? '暂停' : '开始' }}
				</button>
			</div>
		</div>
		<script src="https://cdn.jsdelivr.net/npm/vue"></script>
		<script type="module">
			import foods from './foods.js';

			new Vue({
				el: '#container',
				data: {
					foods,
					food: '',
					currentTime: '',
					btnText: '开始',
					randomFoods: false,
					randomObj: null,
					timeObj: null
				},
				methods: {
					startRandom() {
						if (!this.randomFoods) {
							this.randomObj = setInterval(() => {
								this.food = this.foods[Math.floor(Math.random() * this.foods.length)];
							}, 100);
							this.randomFoods = true;
						} else {
							clearInterval(this.randomObj);
							this.randomFoods = false;
						}
					},
					setCurrentTime() {
						this.timeObj = setInterval(() => {
							this.currentTime = this.dateFormat('YYYY-mm-dd HH:MM:SS', new Date());
						}, 1000);
					},
					dateFormat(fmt, date) {
						let ret;
						const opt = {
							'Y+': date.getFullYear().toString(), // 年
							'm+': (date.getMonth() + 1).toString(), // 月
							'd+': date.getDate().toString(), // 日
							'H+': date.getHours().toString(), // 时
							'M+': date.getMinutes().toString(), // 分
							'S+': date.getSeconds().toString() // 秒
							// 有其他格式化字符需求可以继续添加，必须转化成字符串
						};
						for (let k in opt) {
							ret = new RegExp('(' + k + ')').exec(fmt);
							if (ret) {
								fmt = fmt.replace(
									ret[1],
									ret[1].length === 1 ? opt[k] : opt[k].padStart(ret[1].length, '0')
								);
							}
						}
						return fmt;
					}
				},
				mounted() {
					this.setCurrentTime();
				}
			});
		</script>
	</body>
</html>
